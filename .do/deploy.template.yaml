# This entire specification is nested under the 'spec' key,
# which is required for the Deploy to DigitalOcean button.
spec:
  # Name for the DigitalOcean App
  name: rasa-pro-app

  # Services to be deployed
  services:
  - name: rasa-pro
    # Build the image from the Dockerfile in the root of the repository.
    # For Dockerfile-based deployments from the same repo, you do not use the 'git' key.
    dockerfile_path: Dockerfile
    
    # The instance size slug. 'basic-xs' is a good starting point.
    instance_size_slug: basic-xs
    instance_count: 1

    # HTTP port the service listens on
    http_port: 5005

    # Default route for incoming traffic
    routes:
    - path: /

    # Environment variables.
    # The user will be prompted to enter values for these secrets during deployment.
    envs:
    - key: RASA_PRO_LICENSE
      type: SECRET
      value: "" # Placeholder, value to be provided in the UI
    - key: OPENAI_API_KEY
      type: SECRET
      value: "" # Placeholder, value to be provided in the UI

    # Attach a persistent storage volume
    volumes:
    - name: rasa-models
      mount_path: /app/models
      bind_to_build: true

  # Definition for the persistent volume
  volumes:
  - name: rasa-models
    size_gb: 10